return strand
    .Select((s, i) => i)
    .Where(i => i % 3 == 0)
    .Select(i => strand.Substring(i, 3))
    .TakeWhile(s => proteins[s] != "STOP")
    .Select(s => proteins[s]).ToArray();
